# è§†é¢‘ä½œè€…ä¿¡æ¯è§£æ API é›†æˆæ–‡æ¡£ (æŠ–éŸ³ + Bç«™)

## 1. åŠŸèƒ½æ¦‚è¿°

æœ¬æ¨¡å—ç”¨äºä»ç”¨æˆ·åˆ†äº«çš„è§†é¢‘é“¾æ¥ä¸­ï¼Œè‡ªåŠ¨è§£ææå–è§†é¢‘ä½œè€…çš„å…³é”®ä¿¡æ¯ã€‚
**æ ¸å¿ƒèƒ½åŠ›**ï¼šç»•è¿‡ç½‘é¡µé£æ§ï¼Œç²¾å‡†æå–ä½œè€…å¤´åƒã€æ˜µç§°ã€ä¸»é¡µè·³è½¬é“¾æ¥ã€‚

**æ”¯æŒå¹³å°**ï¼š
1.  **æŠ–éŸ³ (Douyin)**ï¼š
    * æ”¯æŒï¼šçŸ­é“¾æ¥ (`v.douyin.com`)ã€é•¿é“¾æ¥ (`www.douyin.com`)ã€‚
    * æŠ€æœ¯ï¼šiPad User-Agent ä¼ªè£… + è·¯ç”±ç‰¹å¾æå–ã€‚
2.  **å“”å“©å“”å“© (Bilibili)**ï¼š
    * æ”¯æŒï¼šçŸ­é“¾æ¥ (`b23.tv`)ã€ç½‘é¡µé“¾æ¥ (`www.bilibili.com`)ã€‚
    * æŠ€æœ¯ï¼šå®˜æ–¹ API (`api.bilibili.com`) è°ƒç”¨ + BV å·è‡ªåŠ¨æå–ã€‚

---

## 2. æ¥å£å®šä¹‰ (åç«¯)

è¯·åœ¨ Supabase åˆ›å»º Edge Function: `get-video-author`

* **Endpoint**: `https://baxjlmfcumlmfbcmykld.supabase.co/functions/v1/get-video-author`
* **Method**: `POST`
* **Auth**: Bearer Token (Supabase Anon Key)

```
VITE_SUPABASE_ANON_KEY=sb_publishable_eMS0k7d6WqfGuE93yLtJyg_9pmKcvO8
```

### 2.1 è¯·æ±‚å‚æ•°
**Content-Type**: `application/json`

| å‚æ•° | ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
| :--- | :--- | :--- | :--- |
| `url` | `string` | åŒ…å«é“¾æ¥çš„åˆ†äº«æ–‡æ¡ˆ | `ã€æ·±å¤œ2ä¸‡äººè§‚çœ‹ï¼ã€‘ https://www.bilibili.com/video/BV19rmoBqEdK/` |

### 2.2 å“åº”å‚æ•°
**Content-Type**: `application/json`

**æˆåŠŸ (200 OK)**:
```json
{
  "status": "success",
  "data": {
    "username": "ä¹ƒç³Queen",
    "avatar": "[https://i2.hdslb.com/bfs/face/xxxx.jpg](https://i2.hdslb.com/bfs/face/xxxx.jpg)",
    "user_home_url": "[https://space.bilibili.com/672328094](https://space.bilibili.com/672328094)",
    "is_cover": false,
    "source": "bilibili"
  }
}
```
å­—æ®µè¯´æ˜:

user_home_url: ä½œè€…ä¸»é¡µé“¾æ¥ï¼ˆç”¨äºç‚¹å‡»è·³è½¬ï¼‰ã€‚

is_cover: å¦‚æœä¸º trueï¼Œè¯´æ˜æ²¡æŠ“åˆ°å¤´åƒï¼Œç”¨è§†é¢‘å°é¢ä»£æ›¿ã€‚

source: è¯†åˆ«åˆ°çš„å¹³å° (douyin / bilibili)ã€‚

3. å‰ç«¯å¼€å‘æ³¨æ„äº‹é¡¹
ğŸš¨ å¿…é¡»é…ç½®é˜²ç›—é“¾ (Referrer Policy)
æŠ–éŸ³å’Œ Bç«™çš„å›¾ç‰‡éƒ½æœ‰é˜²ç›—é“¾æœºåˆ¶ã€‚åœ¨å‰ç«¯æ˜¾ç¤ºå›¾ç‰‡æ—¶ï¼Œå¿…é¡»ç»™ <img /> æ ‡ç­¾æ·»åŠ  referrerPolicy="no-referrer"ï¼Œå¦åˆ™å›¾ç‰‡ä¼šè£‚å¼€ (403 Forbidden)ã€‚

React ç¤ºä¾‹:

```
<img 
  src={data.avatar} 
  referrerPolicy="no-referrer"  // ğŸ”¥ å…³é”®ä»£ç 
  onError={(e) => e.target.src = '/default-avatar.png'} 
/>
```